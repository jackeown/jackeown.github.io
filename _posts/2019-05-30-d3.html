---
layout: default
author: Jack
title: Playing Around with D3.js 
---

<script src="https://d3js.org/d3.v4.js"></script>

<script>

    class LinePlot extends HTMLElement {
        static observedAttributes = ['data'];

        constructor() {
            // Always call super first in constructor
            super();
            
            // Set up canvas 
            this.shadow = this.attachShadow({mode: 'open'});
            this.canvas = document.createElement("canvas");
            this.canvas.setAttribute("style","border:1px black solid;width:100%;height:100%;");
            this.ctx = this.canvas.getContext("2d");
            this.shadow.appendChild(this.canvas);
            this.dpiInterval = setInterval(this.fixDPI.bind(this), 500);
            setTimeout(this.renderPlot.bind(this), 1000);
        }

        attributeChangedCallback(name, oldValue, newValue) {
            console.log("custom element attribute changed!");
            this.renderPlot();
        }


        fixDPI() {
            //the + prefix casts it to an integer
            //the slice method gets rid of "px"
            let style_height = +getComputedStyle(this.canvas).getPropertyValue("height").slice(0, -2);
            let style_width = +getComputedStyle(this.canvas).getPropertyValue("width").slice(0, -2);

            //scale the canvas
            if(this.canvas.getAttribute('height') != style_height*window.devicePixelRatio ||
               this.canvas.getAttribute('width')  != style_width*window.devicePixelRatio ){
                this.canvas.setAttribute('height', style_height * window.devicePixelRatio);
                this.canvas.setAttribute('width', style_width * window.devicePixelRatio);
                this.renderPlot();
            }
        }



        renderPlot(){
            this.drawAxes();
            this.drawLine();

            this.ctx.strokeStyle="black";
            this.ctx.lineWidth = 10;
            let w = this.canvas.width-40;
            let h = this.canvas.height-40;
            this.ctx.strokeRect(20,20,w,h);
        }


        drawAxes(){
            let data = JSON.parse(this.getAttribute('data'));
            if(data == null){
                return
            }
            xmin = -Infinity;
        }

        drawLine(){
            let data = JSON.parse(this.getAttribute('data'));
            if(data == null){
                return
            }
            for(let x of data.xs){
                for(let y of data.ys){
                    
                }
            }
        }

    }

    customElements.define('line-plot', LinePlot);

</script>


<div style="width:100%;height:200px;">
    <line-plot id="myPlot"></line-plot>
</div>

<script>
// d3.csv("https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/5_OneCatSevNumOrdered.csv", function(data){
//     d3.select("#myPlot").attr("data",JSON.stringify(data));
// });
</script>